!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.AdequateTabs=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d;d=a("./tabbed.coffee"),b.exports={TabbedView:d}},{"./tabbed.coffee":3}],2:[function(a,b,c){var d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;Backbone.History.prototype.route=function(a,b,c){this.handlers.unshift({router:c,route:a,callback:b})},d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.initialize=function(a){Marionette.AppRouter.prototype.initialize.apply(this,arguments),_.bindAll(this,"checkState"),_.defer(this.checkState)},b.prototype.checkState=function(){Backbone.History.started?Backbone.history.loadUrl():(Backbone.history||(Backbone.history=new Backbone.History),Backbone.history.start({pushState:!0}))},b.prototype.route=function(a,b,c){var d;return _.isRegExp(a)||(a=this._routeToRegExp(a)),_.isFunction(b)&&(c=b,b=""),c||(c=this[b]),d=this,Backbone.history.route(a,function(e){var f;f=d._extractParameters(a,e),d.execute(c,f),d.trigger.apply(d,["route:"+b].concat(f)),d.trigger("route",b,f),Backbone.history.trigger("route",d,b,f)},this),this},b.prototype._addAppRoute=function(a,b,c){this.options.scope&&(b=this.options.scope+"/"+b),Marionette.AppRouter.prototype._addAppRoute.apply(this,[a,b,c])},b.prototype.navigate=function(a,b){var c,d,e,f;return b=b||{},c=Backbone.history.fragment,f=_.isFunction(this.options.scope)?this.options.scope():this.options.scope,d={},e=void 0,!f||(a?(a=f+"/"+a,e=new RegExp(f+"/?$","i"),c.match(e)&&(d.replace=!0)):a=f,e=new RegExp(f,"i"),c.match(e)||b.force)?(e=new RegExp(a),c.match(e)&&!b.force?this:(e=new RegExp(a+"/?$","i"),c.match(e)&&(d.replace=!0),_.defaults(b,d),Marionette.AppRouter.prototype.navigate.apply(this,[a,b]))):(console.error("Tab URL is out of scope.",f,c),this)},b.prototype.destroy=function(){Backbone.history.handlers=_.filter(Backbone.history.handlers,function(a){return a.router!==this},this)},b}(Marionette.AppRouter),b.exports=d},{}],3:[function(a,b,c){var d,e,f,g;e=a("./tabs.coffee"),g=[],f=function(a){var b,c,d,e;if(e=_.last(g))switch(b=e.tabs.model.get("current_tab_id"),a.which){case 37:c=e.tabs.collection.first().get("id"),c===b?g.length>1&&(g.pop(),f(a)):e.triggerMethod("previous");break;case 39:d=e.tabs.collection.last().get("id"),d===b?g.length>1&&(g.pop(),f(a)):e.triggerMethod("next")}},$(window).on("keyup",f),d=Marionette.LayoutView.extend({className:"tabbed",template:_.template('<div class="tab-nav"></div><div class="tab-content"></div>'),regions:{nav:".tab-nav",content:".tab-content"},initialize:function(){g.push(this),this.listenTo(this.tabs.model,"change:current_tab_id",this.onChangeTab)},onBeforeDestroy:function(){g=_.filter(g,function(a){return a.cid!==this.cid},this)},onChangeTab:function(a,b){},behaviors:function(){var a;return a=_.extend({behaviorClass:e,region:this.content,tabs:[],nav:{region:this.nav}},_.result(this,"tabOptions")),{Tabs:a}}}),b.exports=d},{"./tabs.coffee":4}],4:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},o={}.hasOwnProperty;i=a("./router.coffee"),m=void 0,f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.initialize=function(){this.cid=_.uniqueId("controller"),this.scope_model=new Backbone.Model},b.prototype.setCurrentTabIdForScope=function(a,b){if(a){if(!b)throw new Error("tab_id required");this.scope_model.set(a,b)}},b.prototype.getCurrentTabIdForScope=function(a){return this.scope_model.get(a)||""},b}(Marionette.Controller),j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.defaults={destroy:!0,label:"",viewOptions:{},visible:!0},b.prototype.initialize=function(){Backbone.Model.prototype.initialize.apply(this,arguments),this.on("invalid",function(){console.error(this.get("id"),this.validationError)})},b.prototype.getView=function(){var a,b,c;return a=this.get("view"),b=this.get("viewOptions"),_.isFunction(b)&&(b=b()),console.log("view options are:"),console.log(b),c=new a(b),c.$el.addClass("tab tab-"+this.get("id")),c},b.prototype.validate=function(a){return a.id?a.view?a.view.prototype instanceof Backbone.View?_.isUndefined(a.label)?"Tab requires a label.":void 0:"Tab view must be a Backbone.View":"Tab requires a view.":"Tab requires an id."},b}(Backbone.Model),k=Backbone.Collection.extend({model:j}),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.tagName="li",b.prototype.className="Tab",b.prototype.template=_.template("<%= label %>"),b.prototype.triggers={click:"item:click"},b}(Marionette.ItemView),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.tagName="ul",b.prototype.className="Tabs",b.prototype.childView=d,b.prototype.initialize=function(a){if(!a.tabs)throw new Error("Tabnav requires tabs.");this.tabs=a.tabs,this.listenTo(this.tabs.model,"change:current_tab_id",this.setActiveItem),this.listenTo(this,"render",this.setActiveItem),this.listenTo(this.collection,"change:visible",this.onChangeTabVisible),window.foobuttons=this},b.prototype.onEvent=function(){},b.prototype.childEvents={"item:click":"onClickItem"},b.prototype.onClickItem=function(a){this.tabs.setCurrentTabId(a.model.get("id"))},b.prototype.setActiveItem=function(){var a,b;this.$(".active").removeClass("active"),a=this.tabs.getCurrentTab(),a&&(b=this.children.findByModel(a),b.$el.addClass("active"))},b.prototype.showCollection=function(){var a,b;a=void 0,b=this.collection.where({visible:!0}),_(b).each(function(b,c){a=this.getChildView(b),this.addChild(b,a,c)},this)},b.prototype.onChangeTabVisible=function(a,b,c){var d,e;b?this.render():(d=this.collection.indexOf(a)-1||0,e=this.children.findByModel(a),e.remove(),this.tabs.showTabByIndex(d))},b}(Marionette.CollectionView),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.tagName="option",b.prototype.template=_.template("<%= label %>"),b.prototype.initialize=function(){this.$el.attr("value",this.model.cid)},b}(Marionette.ItemView),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.tagName="select",b.prototype.className="tabmenu",b.prototype.childView=g,b.prototype.initialize=function(a){if(!a.tabs)throw new Error("Tabnav requires tabs.");this.tabs=a.tabs,this.collection=a.tabs.collection,this.listenTo(this.tabs.model,"change:current_tab_id",this.setActiveItem),this.listenTo(this,"render",this.setActiveItem)},b.prototype.events={change:"onSelectItem"},b.prototype.onRender=function(){this.$el.prepend("<option disabled>Select one:</option>")},b.prototype.onSelectItem=function(){var a,b;a=this.$el.val(),b=this.collection.get(a),this.tabs.setCurrentTabId(b.get("id"))},b.prototype.setActiveItem=function(){var a;a=this.tabs.getCurrentTab(),a&&a.cid&&this.$el.val(a.cid)},b}(Marionette.CollectionView),l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.initialize=function(){var a,b;if(this.options=this.options||{},a=localStorage.getItem("demodelay")||0,_.defaults(this.options,{tabs:[],routing:!0,show_initial_tab:!0,initial_tab_id:"",wraparound:!1}),!this.options.region)throw new Error("Tabs behavior requires a region");a&&(this.options.show_initial_tab=!1),this.cid=_.uniqueId("tabs"),this.view.tabs=this,m||(m=new f),this.options.initial_tab_id||(b=m.getCurrentTabIdForScope(this.options.scope),b&&(this.options.initial_tab_id=b)),_.bindAll(this,"initializeRouter"),_.delay(this.initializeRouter,a),this.model=new Backbone.Model({current_tab_id:this.options.initial_tab_id}),this.collection=new k,_.bindAll(this,"autoShowFirstTab"),this.autoShowFirstTab=_.debounce(this.autoShowFirstTab,20),window.footabs=this},b.prototype.initializeRouter=function(){this.options.routing&&(this.router=new i({controller:this,scope:this.options.scope,appRoutes:{"(:tab_id)(/)(*params)":"routeTabId"}}))},b.prototype.onShow=function(){this.listenTo(this.model,"change:current_tab_id",this.onChangeCurrentTabId),this.on("next",this.showNextTab),this.on("previous",this.showPreviousTab),this.addTabs(this.options.tabs),this.options.nav&&this.createNav(),_.defer(this.autoShowFirstTab)},b.prototype.onDestroy=function(){this.router&&this.router.destroy()},b.prototype.onChangeCurrentTabId=function(a,b,c){this.showCurrentTab(c),m.setCurrentTabIdForScope(this.options.scope,this.model.get("current_tab_id"))},b.prototype.addTab=function(a){return a instanceof j||(a=new j(a)),a.isValid()?void this.collection.add(a):a.validationError},b.prototype.addTabs=function(a){_.each(a,function(a){this.addTab(a)},this)},b.prototype.getTabById=function(a){return this.collection.findWhere({id:a})},b.prototype.getCurrentTab=function(){var a;return a=this.model.get("current_tab_id"),this.getTabById(a)},b.prototype.showCurrentTab=function(a){var b,c,d,e;if(a=a||{},d=this.getCurrentTab(),d&&d.isValid()){if(d.get("shown"))return;c=this.model.get("last_tab_id"),b=this.getTabById(c),b&&(a.preventDestroy=!b.get("destroy")),e=d.getView(),this.view.triggerMethod("before:show:tab",e),this.options.region.show(e,a),d.set("shown",!0),this.listenTo(e,"destroy",function(){d.unset("shown")}),this.view.triggerMethod("show:tab",e),this.setHistory(a)}},b.prototype.routeTabId=function(a){this.setCurrentTabId(a)},b.prototype.setCurrentTabId=function(a,b){var c,d;b=b||{},d=this.getTabById(a),d&&d.isValid()&&(c=this.model.get("current_tab_id"),this.model.set("last_tab_id",c,b),this.model.set("current_tab_id",a,b))},b.prototype.showTabById=function(a,b){this.setCurrentTabId(a,b)},b.prototype.showTabByIndex=function(a){var b;this.options.wraparound?(0>a&&(a=this.collection.length-1),a>this.collection.length-1&&(a=0)):(a=Math.max(0,a),a=Math.min(a,this.collection.length-1)),b=this.collection.at(a),this.setCurrentTabId(b.get("id"))},b.prototype.showNextTab=function(){var a,b;b=this.getCurrentTab(),a=this.collection.indexOf(b),a++,this.showTabByIndex(a)},b.prototype.showPreviousTab=function(){var a,b;b=this.getCurrentTab(),a=this.collection.indexOf(b),a--,this.showTabByIndex(a)},b.prototype.autoShowFirstTab=function(){var a;this.options.show_initial_tab&&(this.model.get("current_tab_id")?this.showCurrentTab():(a=this.collection.first(),a&&this.setCurrentTabId(a.get("id"),{replace:!0})))},b.prototype.createNav=function(){var a;if(_.defaults(this.options.nav,{view:e,viewOptions:{}}),!this.options.nav.region)throw new Error("Tab nav requires a region");a=_.extend(this.options.nav.viewOptions,{tabs:this,collection:this.collection}),this.nav=new this.options.nav.view(a),this.options.nav.region.show(this.nav)},b.prototype.setHistory=function(a){var b;this.router&&(b=this.model.get("current_tab_id"),this.router.navigate(b,a))},b}(Marionette.Behavior),l.ButtonBarView=e,l.MenuView=h,b.exports=l},{"./router.coffee":2}]},{},[1])(1)});